# Internationalization (i18n) Guidelines

SafeVoice is designed with full internationalization support to serve users across multiple languages and regions. This document provides guidelines for maintaining and extending the i18n system.

## Supported Languages

SafeVoice currently supports the following languages:

- **English** (en) - Default language
- **Hindi** (hi)
- **Bengali** (bn)
- **Tamil** (ta)
- **Telugu** (te)
- **Marathi** (mr)

## Architecture

### Core Configuration
- **File**: `src/i18n/config.ts`
- **Purpose**: Centralized i18n configuration using i18next
- **Features**:
  - Language detection (localStorage → browser language → default)
  - Automatic language persistence
  - Document language and direction attributes
  - Fallback to English for missing translations

### Translation Files
- **Location**: `src/i18n/locales/`
- **Format**: JSON
- **Files**: `en.json`, `hi.json`, `bn.json`, `ta.json`, `te.json`, `mr.json`
- **Structure**: Nested namespace organization (see examples below)

### Usage in Components
```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();
  
  return (
    <div>
      <h1>{t('common.appName')}</h1>
      <p>{t('settings.privacy.title')}</p>
    </div>
  );
}
```

## Translation Namespace Organization

Translations are organized hierarchically by feature/domain:

```
{
  "common": {
    "appName": "SafeVoice",
    "loading": "Loading...",
    ...
  },
  "nav": { ... },
  "settings": {
    "privacy": { ... },
    "fingerprint": { ... }
  },
  "privacy": {
    "hub": {
      "title": "Privacy Education Hub",
      "diagrams": { ... },
      "faq": { ... },
      "onboarding": { ... },
      "cta": { ... }
    }
  }
}
```

## Adding New Translations

### Step 1: Define Keys in English
Add the new keys to `src/i18n/locales/en.json`:

```json
{
  "myFeature": {
    "title": "My Feature",
    "description": "This is my new feature",
    "actions": {
      "save": "Save",
      "cancel": "Cancel"
    }
  }
}
```

### Step 2: Translate to All Supported Languages
Add translations for all 6 languages in the same structure:

- `src/i18n/locales/hi.json`
- `src/i18n/locales/bn.json`
- `src/i18n/locales/ta.json`
- `src/i18n/locales/te.json`
- `src/i18n/locales/mr.json`

**Important**: Maintain the exact same key structure across all locales. Missing keys will fall back to English.

### Step 3: Use in Components
Wire the `useTranslation` hook in your component:

```tsx
import { useTranslation } from 'react-i18next';

export function MyFeature() {
  const { t } = useTranslation();
  
  return (
    <div>
      <h1>{t('myFeature.title')}</h1>
      <p>{t('myFeature.description')}</p>
      <button>{t('myFeature.actions.save')}</button>
    </div>
  );
}
```

### Step 4: Add Tests
Create or update tests to verify your new translations:

```typescript
it('should have myFeature keys in all languages', async () => {
  for (const lang of Object.keys(SUPPORTED_LANGUAGES)) {
    await i18n.changeLanguage(lang);
    
    const title = i18n.t('myFeature.title');
    expect(title).toBeTruthy();
    expect(title).not.toBe('myFeature.title');
  }
});
```

## Naming Conventions

### Key Naming
- Use **camelCase** for keys: `privacyHubTitle` ✓, `privacy_hub_title` ✗
- Use **hierarchical organization**: `settings.privacy.title` rather than flat keys
- Keep keys **descriptive but concise**: `enableFingerprintProtection` not `turnOn`

### Translation Content
- **Be concise**: Avoid unnecessarily long strings
- **Be clear**: Use simple, accessible language
- **Maintain consistency**: Use the same terms throughout
- **Use consistent terminology**: If you use "SafeVoice" in English, use it consistently

## Privacy Content Translation Namespaces

The privacy education content uses a dedicated namespace structure:

### `privacy.hub` Namespace

#### Diagrams Section
- `privacy.hub.diagrams.tracking.title/description`
- `privacy.hub.diagrams.fingerprinting.title/description`
- `privacy.hub.diagrams.dataFlow.title/description`
- `privacy.hub.diagrams.protection.title/description`

#### FAQ Section
- `privacy.hub.faq.title`
- `privacy.hub.faq.questions.{questionKey}.q` - Question text
- `privacy.hub.faq.questions.{questionKey}.a` - Answer text

Available questions:
- `whatIsTracking`
- `howProtected`
- `canIBeAnonymous`
- `whatIsFingerprinting`
- `cookiesUsed`
- `dataSharing`

#### Onboarding Section
- `privacy.hub.onboarding.title`
- `privacy.hub.onboarding.steps.{stepKey}.title/description`

Available steps:
- `welcome`
- `whyPrivacy`
- `ourApproach`
- `protections`
- `gettingStarted`

#### Call-to-Action (CTA) Section
- `privacy.hub.cta.learnMore`
- `privacy.hub.cta.readFaq`
- `privacy.hub.cta.visitSettings`
- `privacy.hub.cta.enableProtection`
- `privacy.hub.cta.startOnboarding`
- `privacy.hub.cta.closeHub`
- `privacy.hub.cta.backToDashboard`
- `privacy.hub.cta.nextStep`
- `privacy.hub.cta.previousStep`
- `privacy.hub.cta.skipOnboarding`
- `privacy.hub.cta.completeOnboarding`

## Testing i18n

### Running Tests
```bash
npm test -- src/i18n/__tests__/privacy-i18n.test.ts
```

### Test Coverage
Tests verify:
- All required keys exist in all supported languages
- No missing translation keys (uses fallback as needed)
- Consistent key structure across locales
- Translation namespace integrity

## Configuration

### Language Detection
The system uses a custom detector that checks in order:
1. **localStorage** - User's saved preference
2. **Browser language** - Navigator language
3. **Default** - English (en)

Language preference is stored in `localStorage` under key `i18nextLng`.

### Fallback Behavior
- **Missing translations**: Fall back to English
- **Empty translations**: Return empty string
- **Invalid keys**: Return the key itself (helps identify missing translations)

### Document Attributes
When language changes, the system updates:
- `<html lang="">` - Language code
- `<html dir="">` - Text direction (all languages currently: `ltr`)

## Common Issues and Solutions

### Issue: Translation key shows instead of text
**Cause**: Key doesn't exist in translation file or key path is incorrect

**Solution**:
1. Check key spelling and structure
2. Verify key exists in all 6 locale files
3. Check `useTranslation` hook is properly imported

### Issue: Translations don't update when language changes
**Cause**: Component not re-rendering on language change

**Solution**:
1. Ensure `useTranslation` hook is used (not manual i18n)
2. Component receives i18n events automatically

### Issue: Missing translations for new language
**Cause**: Incomplete translation in locale file

**Solution**:
1. Compare structure with `en.json`
2. Ensure all keys are present
3. Check for typos in key names

## Maintenance Checklist

When adding new features with i18n needs:

- [ ] Add English translations to `en.json`
- [ ] Add translations to all 5 other locale files
- [ ] Verify key structure matches across all locales
- [ ] Wire `useTranslation` in components
- [ ] Add unit tests for new keys
- [ ] Update this documentation if new namespaces added
- [ ] Test in all supported languages
- [ ] Verify fallback behavior works correctly

## Tools and Utilities

### Changing Language Programmatically
```tsx
import i18n from '@/i18n/config';

// Change language
await i18n.changeLanguage('hi');

// Get current language
const currentLang = i18n.language;
```

### Accessing Translation Resources
```tsx
import i18n from '@/i18n/config';

// Get specific language resource
const resource = i18n.getDataByLanguage('en');
```

### Language Information
```tsx
import { SUPPORTED_LANGUAGES } from '@/i18n/config';

// Get all supported languages
Object.keys(SUPPORTED_LANGUAGES); // ['en', 'hi', 'bn', 'ta', 'te', 'mr']

// Get language info
const lang = SUPPORTED_LANGUAGES.en;
// { name: 'English', nativeName: 'English', dir: 'ltr' }
```

## Contributing Translations

When contributing new translations:

1. **Accuracy**: Ensure translations are accurate and convey the same meaning as English
2. **Consistency**: Use established terminology from existing translations
3. **Cultural Appropriateness**: Consider cultural context for target language
4. **Native Speakers**: When possible, have native speakers review translations
5. **Testing**: Test translations in the UI to ensure proper display
6. **Context**: Include context in commit messages for translation changes

## Future Enhancements

Planned i18n improvements:
- [ ] RTL language support (Arabic, Hebrew)
- [ ] Lazy-loaded translation resources for performance
- [ ] Translation management dashboard
- [ ] Community translation contributions system
- [ ] Automated translation quality checks
- [ ] Support for more languages based on user demand
